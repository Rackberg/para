#!/usr/bin/env php
<?php

use Para\Para;
use Symfony\Component\Config\FileLocator;
use Symfony\Component\DependencyInjection\ContainerBuilder;
use Symfony\Component\DependencyInjection\Loader\YamlFileLoader;

// Include composer autoloader.
if (file_exists(__DIR__ . '/../vendor/autoload.php')) {
    require_once __DIR__ . '/../vendor/autoload.php';
} elseif (file_exists(__DIR__ . '/../../../autoload.php')) {
    require_once __DIR__ . '/../../../autoload.php';
}

// Create the dependency injection container.
$container = new ContainerBuilder();

// Set the root directory.
$container->setParameter('root_dir', __DIR__ . '/../');

// Create the file loader.
$loader = new YamlFileLoader($container, new FileLocator([
    __DIR__ . '/../config/services'
]));

// Load the service configurations.
$loader->load('services.yml');
$loader->load('commands.services.yml');
$loader->load('event.services.yml');

// Create and run the application.
$application = $container->get('para.application');
$application->setContainer($container);
try {
    $application->run();
} catch (\Exception $e) {
    print 'An error occurred while trying to run para.' . "\n" . 'Reason: ' . $e->getMessage();
    exit(1);
}
?>
